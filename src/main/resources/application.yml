spring:
  application:
    name: service-account

# AWS 설정
aws:
  region: ${AWS_REGION:ap-northeast-2}
  sns:
    project-name: ${AWS_SNS_PROJECT_NAME:passit}
    environment: ${AWS_SNS_ENVIRONMENT:dev}
    access-key: ${AWS_SNS_ACCESS_KEY:}
    secret-key: ${AWS_SNS_SECRET_KEY:}

  datasource:
    url: jdbc:mysql://${DB_HOST:localhost}:${DB_PORT:3307}/${DB_NAME:passit_db}?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=Asia/Seoul
    username: ${DB_USER:passit_user}
    password: ${DB_PASSWORD:passit_password}
    driver-class-name: com.mysql.cj.jdbc.Driver

  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        format_sql: true
        dialect: org.hibernate.dialect.MySQLDialect

  # Valkey 설정 (Redis 프로토콜 호환, ElastiCache for Valkey 지원)
  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD:}
      ssl:
        enabled: ${REDIS_SSL:false}
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 2
          max-wait: -1ms
      timeout: 3000ms

  # 캐시 설정
  cache:
    type: redis
    redis:
      time-to-live: 300000  # 기본 TTL: 5분 (밀리초)
      cache-null-values: false
      key-prefix: "account:"

  mail:
    host: smtp.gmail.com
    port: 587
    username: ${MAIL_USERNAME:your-email@gmail.com}
    password: ${MAIL_PASSWORD:your-app-password}
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
            required: true
          connectiontimeout: 5000
          timeout: 5000
          writetimeout: 5000

server:
  port: 8081

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: always
      probes:
        enabled: true
  metrics:
    tags:
      application: service-account
  health:
    # 메일 서비스 health check 비활성화 (로컬 개발 환경에서는 LocalEmailService 사용)
    mail:
      enabled: false
    # health groups 설정 - 메일을 제외한 상태만 확인
    group:
      readiness:
        include: db,diskSpace,ping
      liveness:
        include: ping

logging:
  level:
    com.company.account: DEBUG
    org.springframework: INFO

# 초기 관리자 계정 설정
app:
  admin:
    email: ${ADMIN_EMAIL:admin@passit.com}
    password: ${ADMIN_PASSWORD:admin123!}
    name: ${ADMIN_NAME:관리자}
    nickname: ${ADMIN_NICKNAME:admin}

# 카카오 로그인 설정
# 주의: redirect-uri는 카카오 개발자 콘솔에 등록된 백엔드 콜백 URL이어야 합니다
# 예: http://localhost:8081/api/auth/kakao/callback
kakao:
  rest-api-key: ${KAKAO_REST_API_KEY:39a378862f9d8845f6adccca55348bfa}
  client-secret: ${KAKAO_CLIENT_SECRET:yxzmC0zYJgFDx1wrOZVElMn9W9KTXiyB}
  admin-key: ${KAKAO_ADMIN_KEY:39a378862f9d8845f6adccca55348bfa}
  redirect-uri: ${KAKAO_REDIRECT_URI:http://localhost:8081/api/auth/kakao/callback}
  frontend-url: ${FRONTEND_URL:http://localhost:3000}

# CORS 설정
cors:
  # 허용할 Origin 목록 (쉼표로 구분)
  # 환경 변수 CORS_ALLOWED_ORIGINS가 있으면 우선 사용
  allowed-origins: ${CORS_ALLOWED_ORIGINS:http://localhost:3000,http://localhost:3001}
